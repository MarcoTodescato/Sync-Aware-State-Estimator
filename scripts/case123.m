function mpc = case123
%--------------------------------------------------------------------------
% MATPOWER load case of the 15 nodes distribution feeder from 
%
% Simple and efficient method for load flow solution of radial distribution
% networks.
% D. Das, D.P. Kothari, A. Kalam.
% Electrical Power and Energy Systems 1995
% URL: http://www.sciencedirect.com/science/article/pii/0142061595000500
%--------------------------------------------------------------------------

%--------------------------------------------------------------------------
% additinal data for the case
%--------------------------------------------------------------------------
VSC = 4160;
ISC = 1;

P = 1e3*[ 0; ...                %150
    0; ...                %149
    13.3333333333333; ...
    6.66666666666667; ...
    0; ...                %3
    13.3333333333333; ...
    6.66666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    0; ...                %8
    13.3333333333333; ...
    6.66666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    0; ...                %13
    0; ...                %14
    0; ...                %15
    13.3333333333333; ...
    6.66666666666667; ...
    0; ...                %18
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %21
    13.3333333333333; ...
    0; ...                %23
    13.3333333333333; ...
    0; ...                %25
    0; ...                %26
    0; ...                %27
    13.3333333333333; ...
    13.3333333333333; ...
    13.3333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    13.3333333333333; ...
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %36
    13.3333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %40
    6.66666666666667; ...
    6.66666666666667; ...
    13.3333333333333; ...
    0; ...                %44
    6.66666666666667; ...
    6.66666666666667; ...
    35; ...
    70; ...
    46.6666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %54
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %57
    6.66666666666667; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %61
    13.3333333333333; ...
    13.3333333333333; ...
    25; ...
    46.6666666666667; ...
    25; ...
    0; ...                %67
    6.66666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    13.3333333333333; ...
    0; ...                %72
    13.3333333333333; ...
    13.3333333333333; ...
    13.3333333333333; ...
    81.6666666666667; ...
    13.3333333333333; ...
    0; ...                %78
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %81
    13.3333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %89
    13.3333333333333; ...
    0; ...                %91
    13.3333333333333; ...
    0; ...                %93
    13.3333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %97
    13.3333333333333; ...
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %101
    6.66666666666667; ...
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %105
    13.3333333333333; ...
    13.3333333333333; ...
    0; ...                %108
    13.3333333333333; ...
    0; ...                %110
    6.66666666666667; ...
    6.66666666666667; ...
    13.3333333333333; ...
    6.66666666666667; ...
    0; ...                %135
    0; ...                %152
    0; ...                %160
    0; ...                %197
    0; ...                %250
    0; ...                %300
    0]';                   %450

Q = 1e3*[ 0; ...                %150
    0; ...                %149
    6.66666666666667; ...
    3.33333333333333; ...
    0; ...                %3
    6.66666666666667; ...
    3.33333333333333; ...
    6.66666666666667; ...
    3.33333333333333; ...
    0; ...                %8
    6.66666666666667; ...
    3.33333333333333; ...
    6.66666666666667; ...
    3.33333333333333; ...
    0; ...                %13
    0; ...                %14
    0; ...                %15
    6.66666666666667; ...
    3.33333333333333; ...
    0; ...                %18
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %21
    6.66666666666667; ...
    0; ...                %23
    6.66666666666667; ...
    0; ...                %25
    0; ...                %26
    0; ...                %27
    6.66666666666667; ...
    6.66666666666667; ...
    6.66666666666667; ...
    3.33333333333333; ...
    3.33333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %36
    6.66666666666667; ...
    3.33333333333333; ...
    3.33333333333333; ...
    0; ...                %40
    3.33333333333333; ...
    3.33333333333333; ...
    6.66666666666667; ...
    0; ...                %44
    3.33333333333333; ...
    3.33333333333333; ...
    25; ...
    50; ...
    31.6666666666667; ...
    6.66666666666667; ...
    3.33333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %54
    3.33333333333333; ...
    3.33333333333333; ...
    0; ...                %57
    3.33333333333333; ...
    3.33333333333333; ...
    3.33333333333333; ...
    0; ...                %61
    6.66666666666667; ...
    6.66666666666667; ...
    11.6666666666667; ...
    33.3333333333333; ...
    11.6666666666667; ...
    0; ...                %67
    3.33333333333333; ...
    6.66666666666667; ...
    3.33333333333333; ...
    6.66666666666667; ...
    0; ...                %72
    6.66666666666667; ...
    6.66666666666667; ...
    6.66666666666667; ...
    60; ...
    6.66666666666667; ...
    0; ...                %78
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %81
    6.66666666666667; ...
    3.33333333333333 - 200; ...
    3.33333333333333; ...
    6.66666666666667; ...
    3.33333333333333; ...
    6.66666666666667; ...
    6.66666666666667 - 16.67; ...
    0; ...                %89
    6.66666666666667 - 16.67; ...
    0; ...                %91
    6.66666666666667 - 16.67; ...
    0; ...                %93
    6.66666666666667; ...
    3.33333333333333; ...
    3.33333333333333; ...
    0; ...                %97
    6.66666666666667; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %101
    3.33333333333333; ...
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %105
    6.66666666666667; ...
    6.66666666666667; ...
    0; ...                %108
    6.66666666666667; ...
    0; ...                %110
    3.33333333333333; ...
    3.33333333333333; ...
    6.66666666666667; ...
    3.33333333333333; ...
    0; ...                %135
    0; ...                %152
    0; ...                %160
    0; ...                %197
    0; ...                %250
    0; ...                %300
    0]';                   %450

FromBus = [1
     3
     3
     3
     5
     5
     7
     9
    10
    10
    10
    11
    15
    15
    16
    16
    17
    17
    20
    20
    21
    23
    23
    25
    25
    27
    27
    28
    28
    29
    30
    31
    32
    33
    36
    37
    37
    38
    38
    40
    42
    42
    44
    44
    46
    46
    47
    49
    49
    51
    52
    54
    55
    56
    56
    57
    59
    59
    60
    62
    62
    64
    65
    66
    67
    69
    69
    69
    70
    71
    72
    74
    74
    75
    76
    78
    78
    79
    80
    80
    82
    83
    83
    84
    86
    88
    89
    89
    91
    91
    93
    93
    95
    95
    97
    99
   100
   101
   102
   103
   103
   104
   105
   107
   107
   108
   110
   110
   111
   112
   112
   114
   115
   117
     2
   118
   119
   120
    15
    20
    62
    99]';

ToBus = [2
     4
     5
     9
     6
     7
     8
    10
    14
    11
    15
    16
    36
    20
    13
    12
    18
    19
    21
    23
    22
    24
    25
    26
    27
    28
    30
    29
    33
    35
    31
    32
   121
    34
    17
    38
    42
    39
    40
    41
    43
    44
    45
    46
    47
    49
    48
    50
    51
    52
    53
    55
    56
    57
    59
    58
    60
    62
    61
    63
    64
    65
    66
    67
    68
    70
    74
    99
    71
    72
    73
    75
    78
    76
    77
    79
    88
    80
    81
    82
    83
    84
    86
    85
    87
    89
    90
    91
    92
    93
    94
    95
    96
    97
    98
   100
   101
   102
   123
   104
   107
   105
   106
   108
   110
   109
   111
   122
   112
   113
   114
   115
   116
    37
     3
    54
    69
   103
   118
   117
   119
   120]';

R = [ 0.01; ...             %switch 150-149
    0.0146849747474747; ...
    0.0209785353535354; ...
    0.0262443181818182; ...
    0.0167828282828283; ...
    0.027272095959596; ...
    0.0209785353535354; ...
    0.0174962121212121; ...
    0.0188806818181818; ...
    0.0188806818181818; ...
    0.0262443181818182; ...
    0.0356635101010101; ...
    0.0125871212121212; ...
    0.072171875; ...
    0.0209785353535354; ...
    0.0209785353535354; ...
    0.031467803030303; ...
    0.0293699494949495; ...
    0.0209785353535354; ...
    0.0262443181818182; ...
    0.027272095959596; ...
    0.0440549242424242; ...
    0.0218702651515152; ...
    0.0461527777777778; ...
    0.0240572916666667; ...
    0.0203083964646465; ...
    0.0174962121212121; ...
    0.0159565972222222; ...
    0.0188806818181818; ...
    0.0419570707070707; ...
    0.0262443181818182; ...
    0.0306183712121212; ...
    0.0174962121212121; ...
    0.0251742424242424; ...
    0.00839141414141414; ...
    0.0377155934343434; ...
    0.0218702651515152; ...
    0.0251742424242424; ...
    0.0209785353535354; ...
    0.027272095959596; ...
    0.027272095959596; ...
    0.0218702651515152; ...
    0.0419570707070707; ...
    0.0174962121212121; ...
    0.0167828282828283; ...
    0.0218702651515152; ...
    0.0251742424242424; ...
    0.0131221590909091; ...
    0.0218702651515152; ...
    0.0218702651515152; ...
    0.0218702651515152; ...
    0.0174962121212121; ...
    0.0109351325757576; ...
    0.0240572916666667; ...
    0.0306183712121212; ...
    0.0240572916666667; ...
    0.0209785353535354; ...
    0.0656107954545454; ...
    0.0209785353535354; ...
    0.0481145833333333; ...
    0.0722017045454545; ...
    0.0505411931818182; ...
    0.101082386363636; ...
    0.122742897727273; ...
    0.0938622159090909; ...
    0.0167828282828283; ...
    0.0240572916666667; ...
    0.0218702651515152; ...
    0.0230763888888889; ...
    0.027272095959596; ...
    0.0230763888888889; ...
    0.0230763888888889; ...
    0.0174962121212121; ...
    0.0293699494949495; ...
    0.0335656565656566; ...
    0.0349924242424242; ...
    0.0612367424242424; ...
    0.00874810606060606; ...
    0.0196832386363636; ...
    0.0415535037878788; ...
    0.0415535037878788; ...
    0.0218702651515152; ...
    0.0566420454545455; ...
    0.0218702651515152; ...
    0.0398592171717172; ...
    0.0393664772727273; ...
    0.0146849747474747; ...
    0.0240572916666667; ...
    0.0188806818181818; ...
    0.0196832386363636; ...
    0.0251742424242424; ...
    0.0196832386363636; ...
    0.0230763888888889; ...
    0.0262443181818182; ...
    0.0167828282828283; ...
    0.0240572916666667; ...
    0.0481145833333333; ...
    0.0262443181818182; ...
    0.0699848484848485; ...
    0.0188806818181818; ...
    0.0240572916666667; ...
    0.027272095959596; ...
    0.058739898989899; ...
    0.0188806818181818; ...
    0.0284313446969697; ...
    0.0482506313131313; ...
    0.0377613636363636; ...
    0.0874810606060606; ...
    0.0251742424242424; ...
    0.0482506313131313; ...
    0.0104892676767677; ...
    0.0440549242424242; ...
    0.027272095959596; ...
    0.0328053977272727; ...
    0.0349924242424242; ...
    0.0349924242424242; ...
    0.0306183712121212; ...
    0.0218702651515152; ...
    0.1; ...                %switches
    0.1; ...
    0.1; ...
    0.1];


X = [	0.1                 %switch 150-149
    0.0148871527777778; ...
    0.0212673611111111; ...
    0.0604412878787879; ...
    0.0170138888888889; ...
    0.0276475694444444; ...
    0.0212673611111111; ...
    0.0402941919191919; ...
    0.019140625; ...
    0.019140625; ...
    0.0604412878787879; ...
    0.0361545138888889; ...
    0.0127604166666667; ...
    0.166213541666667; ...
    0.0212673611111111; ...
    0.0212673611111111; ...
    0.0319010416666667; ...
    0.0297743055555556; ...
    0.0212673611111111; ...
    0.0604412878787879; ...
    0.0276475694444444; ...
    0.0446614583333333; ...
    0.0503677398989899; ...
    0.0467881944444444; ...
    0.0554045138888889; ...
    0.047353851010101; ...
    0.0402941919191919; ...
    0.0372065972222222; ...
    0.019140625; ...
    0.0425347222222222; ...
    0.0604412878787879; ...
    0.0705148358585859; ...
    0.0402941919191919; ...
    0.0255208333333333; ...
    0.00850694444444444; ...
    0.0879428661616162; ...
    0.0503677398989899; ...
    0.0255208333333333; ...
    0.0212673611111111; ...
    0.0276475694444444; ...
    0.0276475694444444; ...
    0.0503677398989899; ...
    0.0425347222222222; ...
    0.0402941919191919; ...
    0.0170138888888889; ...
    0.0503677398989899; ...
    0.0255208333333333; ...
    0.0302206439393939; ...
    0.0503677398989899; ...
    0.0503677398989899; ...
    0.0503677398989899; ...
    0.0402941919191919; ...
    0.0251838699494949; ...
    0.0554045138888889; ...
    0.0705148358585859; ...
    0.0554045138888889; ...
    0.0212673611111111; ...
    0.15110321969697; ...
    0.0212673611111111; ...
    0.110809027777778; ...
    0.0350441919191919; ...
    0.0245309343434343; ...
    0.0490618686868687; ...
    0.0595751262626263; ...
    0.0455574494949495; ...
    0.0170138888888889; ...
    0.0554045138888889; ...
    0.0503677398989899; ...
    0.0233940972222222; ...
    0.0276475694444444; ...
    0.0233940972222222; ...
    0.0233940972222222; ...
    0.0402941919191919; ...
    0.0297743055555556; ...
    0.0340277777777778; ...
    0.0805883838383839; ...
    0.141029671717172; ...
    0.020147095959596; ...
    0.0453309659090909; ...
    0.0956987058080808; ...
    0.0956987058080808; ...
    0.0503677398989899; ...
    0.057421875; ...
    0.0503677398989899; ...
    0.0404079861111111; ...
    0.0906619318181818; ...
    0.0148871527777778; ...
    0.0554045138888889; ...
    0.019140625; ...
    0.0453309659090909; ...
    0.0255208333333333; ...
    0.0453309659090909; ...
    0.0233940972222222; ...
    0.0604412878787879; ...
    0.0170138888888889; ...
    0.0554045138888889; ...
    0.110809027777778; ...
    0.0604412878787879; ...
    0.161176767676768; ...
    0.019140625; ...
    0.0554045138888889; ...
    0.0276475694444444; ...
    0.0595486111111111; ...
    0.019140625; ...
    0.0654780618686869; ...
    0.0489149305555556; ...
    0.03828125; ...
    0.20147095959596; ...
    0.0255208333333333; ...
    0.0489149305555556; ...
    0.0106336805555556; ...
    0.0446614583333333; ...
    0.0276475694444444; ...
    0.0755516098484849; ...
    0.0805883838383839; ...
    0.0805883838383839; ...
    0.0705148358585859; ...
    0.0503677398989899; ...
    0.1; ...                %switches
    0.1; ...
    0.1; ...
    0.1];

%--------------------------------------------------------------------------
% loadcase version
%--------------------------------------------------------------------------
mpc.version = '2';

%--------------------------------------------------------------------------
% base MVA
%--------------------------------------------------------------------------
mpc.baseMVA = 100;
baseKV = VSC/1e3;
baseZ = baseKV^2/mpc.baseMVA;

R = R/baseZ;
X = X/baseZ;

%--------------------------------------------------------------------------
% bus
%--------------------------------------------------------------------------

mpc.bus = [1:123; ...
           3 ones(1,122); ...
           1e-6*P; ... % P and Q are expressed in W but matpower want them in MW
           1e-6*Q; ...
           zeros(1,123); ...
           zeros(1,123); ...
           ones(1,123); ...
           ones(1,123); ...
           zeros(1,123); ...
           ones(1,123);   ...
           1.06*ones(1,123);...
           0.94*ones(1,123)]';

%--------------------------------------------------------------------------
% generator
%--------------------------------------------------------------------------
mpc.gen = [1; ...
           1.19; ...
           0.45; ...
           Inf; ...
           -Inf; ...
           1; ...
           100; ...
           1; ...
           Inf; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0; ...
           0]';

%--------------------------------------------------------------------------
% branch
%--------------------------------------------------------------------------
mpc.branch = [FromBus; ...
              ToBus; ...
              R'; ...
              X'; ...
              zeros(1,122); ...
              zeros(1,122); ...
              zeros(1,122); ...
              zeros(1,122); ...
              zeros(1,122); ...
              zeros(1,122); ...
              ones(1,122); ...
              -360*ones(1,122); ...
              360*ones(1,122)]';

